---
title: "Statistical Analysis of Flight Fares"
format: html
author:   
  - Anjolaoluwa Olatunbosun   
  - Ayoola Ayetigbo
  - Odomero Omokahfe
date: "4/28/2023"
editor: visual
execute:
  echo: fenced
---

## Introduction.

Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <https://quarto.org>.

## Exploratory Data Analysis

##### LOAD REQUIRED LIBRARIES

```{r}
library(tidyverse)
library(ggplot2)
library(gridExtra)
library(png)
library(grid)
library(lattice)
library(readxl)
library(lubridate)
library(scales)

```

##### LOAD DATASET

```{r}
train <- read_excel("/Users/macbookpro/Downloads/RR_finalProject/Data_Train.xlsx")
```

To get dimension of our dataset, i.e., shape

```{r}
dim(train)
```

To print the top 5 rows of our dataset

```{r}
head(train, 5)
```



##### HANDLING MISSING DATA

To check for missing values and drop missing values

```{r}
print(colSums(is.na(train)))
train <- na.omit(train)

```

##### CLEAN DATE OF JOURNEY VARIABLE

To extract day, month, year, and weekday from Date of Journey

```{r}
train$Journey_Day <- day(dmy(train$Date_of_Journey))
train$Journey_Month <- month(dmy(train$Date_of_Journey))
train$Journey_Year <- year(dmy(train$Date_of_Journey))
train$weekday <- wday(dmy(train$Date_of_Journey), label = TRUE)
```




Remove the Date_of_Journey column since it is no longer needed

```{r}
train$Date_of_Journey <- NULL
```

Now we can see the list of column names in our dataset

```{r}
names(train)
```

##### CLEAN DURATION VARIABLE

Converting duration into minutes. Firstly we define duration function

```{r}
duration <- function(test) {
  test <- gsub("\\s+", "", test) # remove white spaces
  total <- strsplit(test, split = "[a-zA-Z]+")[[1]] # split the string into substrings
  to <- total[1]
  hrs <- as.numeric(gsub("[^[:digit:]]", "", to)) * 60 # extract the hours and convert to minutes
  if (length(total) == 2) {
    mint <- as.numeric(gsub("[^[:digit:]]", "", total[2])) # extract the minutes
    hrs <- hrs + mint
  }
  return(as.character(hrs))
}

```

Apply duration function to the "Duration" column



```{r}
train$Duration <- sapply(train$Duration, duration)
```



Get number of unique values in "Duration" column



```{r}
n_distinct(train$Duration)
```

The `echo: false` option disables the printing of code (only output is displayed).

## Correlation Analysis

## Regression Analysis

## Conclusion
